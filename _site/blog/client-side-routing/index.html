<!DOCTYPE html>
<html lang="ko">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <title>JIYUN.ME | 클라이언트 사이드 라우팅과 단점들</title>
    
        
    <!-- Post info -->
    <meta property="og:site_name" content="JIYUN.ME">
    <meta property="og:type" content="website" /> 
    <meta property="og:url" content="http://localhost:4000/blog/client-side-routing/" />
    
    <meta property="og:image" content="http://localhost:4000/blog/client-side-routing/img/01_2.png">

    <!-- title -->
    <meta property="og:title" content="JIYUN.ME | 클라이언트 사이드 라우팅과 단점들">
    
    <!-- description -->
    <meta property="og:description" content="## 1. 동작 방식 과거에는 유저가 특정 URL을 서버에 요청하면 서버에서 그 URL에 해당하는 결과 페이지를 넘겨주는 단순한 구조였다. 여기에 프론트엔드 프레임워크가 끼면서 요청된 URL에 대해 서버 측과 클라이언트 측..."/>
        
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/uikit.min.css">
    <link rel="stylesheet" href="/assets/css/uikit-width-ex.min.css">
    <link rel="stylesheet" href="/assets/css/ionicons.min.css">
    <link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/assets/css/font-awesome.css">
    <link rel="stylesheet" href="/assets/css/animations.css">
    <link rel="stylesheet" href="/assets/css/theme.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">
    <link rel="stylesheet" href="/assets/css/toc.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" href="/assets/js/prettify/skins/github2.css">
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700%7CLora:400,400i%7CShadows+Into+Light:400" rel="stylesheet" />
    <link rel="shortcut icon" href="/assets/img/favicon_2.ico">
    

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-96635380-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-96635380-1');
    </script>

</head>

    
    <body class="loading">
        

        <!-- NavBar Start -->
        <div class="tw-preloader">
            <div data-uk-spinner></div>
        </div>

        <!-- 
        <div class="header-container tw-header uk-dark">
         -->
        <div class="header-container tw-header tw-header-transparent uk-dark" style="background-color: rgba(255, 255, 255, 0.25);">
        
            <nav class="uk-navbar-container uk-flex-center" data-uk-navbar>

                <!-- NavBar Left Logo Start -->
                <div class="uk-navbar-left">
                    <div class="tw-logo">
                        <h3 class="site-name">
                            <a href="/">JIYUN.ME</a>
                        </h3>
                    </div>
                </div>
                <!-- NavBar Left Logo End -->

                <!-- NavBar Center Menu Start -->
                <div class="uk-navbar-center" id="top">
                    <ul class="tw-main-menu uk-visible@m">
                        <li class="menu-item">
                            <a href="/"  class="normal"  class="active">Home</a>
                        </li>
                        <li class="menu-item">
                            <a href="/projects"  >Projects</a>
                        </li>
                        <li class="menu-item">
                            <a href="/blog"  class="active" >Blog</a>
                        </li>
                        <!-- <li class="menu-item">
                            <a href="/guestbook"  >Guestbook</a>
                        </li> -->
                    </ul>
                </div>
                <!-- NavBar Center Menu End -->

                <!-- NavBar Right Menu Icon Start -->
                <div class="uk-navbar-right">
                    <div class="tw-header-meta">
                        <a class="mobile-menu uk-navbar-toggle uk-hidden@m" href="#" data-uk-toggle="target: #mobile-menu-modal"><i class="ion-navicon-round"></i></a>
                    </div>
                </div>
                <!-- NavBar Right Menu Icon End -->

                <!-- NavBar Right Menu List Start -->
                <div id="mobile-menu-modal" class="uk-modal-full" data-uk-modal>
                    <div class="uk-modal-dialog">
                        <button class="uk-modal-close-full" type="button" data-uk-close></button>
                        <div class="uk-light uk-height-viewport tw-mobile-modal uk-flex uk-flex-middle uk-flex-center" data-uk-scrollspy="target:>ul>li,>div>a; cls:uk-animation-slide-bottom-medium; delay: 150;">
                            <ul class="uk-nav-default" data-uk-nav>
                                <li class="uk-nav-default">
                                    <a href="/"  class="normal"  class="active">Home</a>
                                </li>
                                <li class="uk-nav-default">
                                    <a href="/projects"  >Projects</a>
                                </li>
                                <li class="uk-nav-default">
                                    <a href="/blog"  class="active" >Blog</a>
                                </li>
                                <!-- <li class="uk-nav-default">
                                    <a href="/guestbook"  >Guestbook</a>
                                </li> -->
                            </ul>

                            <div class="tw-socials tw-socials-minimal">
                                <a href="https://github.com/llb1026" target="_blank"><i class="uk-icon-button tw-margin fa fa-github"></i></a>
                                <a href="https://www.linkedin.com/in/jiyun-lee-b19a02153" target="_blank"><i class="uk-icon-button tw-margin fa fa-linkedin"></i></a>
                            </div>

                        </div>
                    </div>
                </div>
                <!-- NavBar Right Menu List End -->

            </nav>
        </div>
        <!-- NavBar End -->
    
        <!-- Content Start -->
        <main>
            <div class="main-container">

    
        <br /><br />
<section class="uk-section-normal uk-section-blog" style="padding-bottom: 0;">
    <div class="uk-container uk-container-small">
        <div data-uk-grid>
            <div class="content-area uk-width-expand">
                <article class="single post">
                    <div class="entry-post">
                        <div class="entry-cats tw-meta">
                            <p>lesson-learned</p>
                        </div>
                        <!-- <h2 class="entry-title post-title">
                            <a href="#">클라이언트 사이드 라우팅과 단점들</a>
                        </h2> -->
                        <div class="heading-title-article post-title">
                            <h2 class="title">클라이언트 사이드 라우팅과 단점들</h2>
                        </div>
                        <div class="entry-date tw-meta">
                            <span>React.js에서 CSR를 구현하며 해 본 다양한 삽질들</span>
                        </div>

                        <!-- Blog Content Start -->
                        <div class="post-article">

                            <!-- Title Image Start -->
                            <div class="entry-media uk-padding-small">
                                <div class="tw-thumbnail" data-uk-lightbox>
                                    <img src="img/01_2.png" alt="" />
                                    <div class="image-overlay">
                                        <a href="img/01_2.png"></a>
                                    </div>
                                </div>
                            </div>
                            <!-- Title Image End -->

                            <!-- Scroll Spy TOC Start -->
                            <div class="toc">
                                <a href="#top">&#x1F446; 맨 위로</a>
                                <ul><li><a href="#1-동작-방식">1. 동작 방식</a></li><li><a href="#2-문제점">2. 문제점</a></li><li><a href="#3-해결-방법">3. 해결 방법</a><ul><li><a href="#3-1-hash-history">3-1. Hash History</a></li><li><a href="#3-2--catch-all">3-2.  Catch-all</a></li><li><a href="#3-3-hybrid">3-3. Hybrid</a></li><li><a href="#3-4-isomorphic">3-4. Isomorphic</a></li></ul></li><li><a href="#4-내가-선택한-방법">4. 내가 선택한 방법</a></li></ul>
                            </div>
                            <!-- Scroll Spy TOC End -->

                            <h2 id="1-동작-방식">1. 동작 방식</h2>

<p>과거에는 유저가 특정 URL을 서버에 요청하면 서버에서 그 URL에 해당하는 결과 페이지를 넘겨주는 단순한 구조였다. 여기에 프론트엔드 프레임워크가 끼면서 요청된 URL에 대해 서버 측과 클라이언트 측 둘 다 어떻게 동작할지 알고 있어야 하게 되었다. 따라서 클라이언트 측에도 라우팅이 필요해졌고, React에서는 <strong>React Router</strong>를 이용해 클라이언트 사이드 라우팅을 할 수 있다.</p>

<p>서버 API에 필요한 데이터를 요청보내는 것을 제외하고, static 리소스 페이지에 대해 React Router는 다음과 같이 동작한다.</p>

<ol>
  <li>맨 처음 요청은 항상 서버로 보내진다.</li>
  <li>서버로부터 React나 React Router 등을 로드하기 위한 필요한 스크립트를 받는다. 이제 React Router가 어느 URL에서 어떤 뷰를 렌더링할 것인지 결정할 수 있다.</li>
  <li>사용자가 버튼이나 링크를 통해 <code class="language-plaintext highlighter-rouge">http://example.com/about</code> 페이지에 접근하면 <a href="https://developer.mozilla.org/en-US/docs/Web/API/History_API#Adding_and_modifying_history_entries">History API</a>를 통해 주소창의 URL이 <em>로컬상에서</em> 바뀐다. 여기서 중요한 점은 서버로 요청이 가는게 아니라, React가 해당 URL에 필요한 뷰를 렌더링해준다.</li>
</ol>

<h2 id="2-문제점">2. 문제점</h2>

<p>만약 위의 1, 2번 단계를 생략하고 바로 주소창에 <code class="language-plaintext highlighter-rouge">http://example.com/about</code>를 입력하면 React Router가 동작하기 전이므로, 해당 요청은 서버로 보내질 것이다. 그러면 서버에서는 <code class="language-plaintext highlighter-rouge">/about</code>에 대해 어떤 응답을 보낼지 알지 못하므로 404 에러가 발생한다.</p>

<p><code class="language-plaintext highlighter-rouge">/about</code> URL은 React Router로 인해 클라이언트 사이드에서는 제대로 동작하지만, 서버 사이드에서는 서버에 <code class="language-plaintext highlighter-rouge">/about</code>에 대해 어떻게 동작할지 명시해주지 않는 이상 정상적으로 응답하지 못한다.</p>

<h2 id="3-해결-방법">3. 해결 방법</h2>

<h3 id="3-1-hash-history">3-1. Hash History</h3>

<p>기존의 문제 상황에서는 다음과 같이 React Router를 사용하고 있었다.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">BrowserRouter</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-router-dom</span><span class="dl">"</span><span class="p">;</span>

<span class="p">...</span>
    <span class="o">&lt;</span><span class="nx">BrowserRouter</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="sr">/App</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/BrowserRouter</span><span class="err">&gt;
</span><span class="p">...</span>
</code></pre></div></div>

<p>여기서 <code class="language-plaintext highlighter-rouge">BrowserRouter</code>를 <code class="language-plaintext highlighter-rouge">HashRouter</code>로 바꿔 적용하면 <a href="https://github.com/jintoppy/react-training/blob/master/basic/node_modules/react-router/docs/guides/Histories.md#browserhistory">BrowserHistory</a> 대신 <a href="https://github.com/jintoppy/react-training/blob/master/basic/node_modules/react-router/docs/guides/Histories.md#hashhistory">HashHistory</a>를 사용하게 되어 URL이 <code class="language-plaintext highlighter-rouge">http://example.com/#/about</code>과 같이 바뀐다. 가운데에 들어간 <code class="language-plaintext highlighter-rouge">#</code> 심볼 이후에 오는 URL 부분은 서버로 보내지지 않고, 서버는 <code class="language-plaintext highlighter-rouge">http://example.com/</code>까지만 보고 이에 해당하는 index 페이지를 응답으로 보내준다. 그리고 React Router가 <code class="language-plaintext highlighter-rouge">#/about</code> 부분에 따라 렌더링을 진행한다.</p>

<p>Hash History 방식에는 아래와 같은 단점이 있다.</p>

<ul>
  <li>URL이 못생겨진다.</li>
  <li>서버 사이드 렌더링이 불가능해진다.</li>
  <li>production 모드에서는 권장하지 않는 방식이다.</li>
  <li>SEO 측면에서 최악이다.</li>
</ul>

<h3 id="3-2--catch-all">3-2.  Catch-all</h3>

<p>BrowserHistory를 사용하되, 서버측에서 <code class="language-plaintext highlighter-rouge">/*</code> 요청에 대해 무조건 index 페이지를 리턴하도록 설정한다. URL이 깔끔해진다.</p>

<p>Catch-all 방식에는 아래와 같은 단점이 있다.</p>

<ul>
  <li>Hash History 방법보다 설정하기가 까다롭다.</li>
  <li>여전히 SEO 측면에서 좋지 않다.</li>
</ul>

<h3 id="3-3-hybrid">3-3. Hybrid</h3>

<p>위의 Catch-all 방법을 좀 더 확장한 것으로, 특정 URL에 대해 어떤 페이지를 리턴할 것인지 정의해놓은 스크립트를 추가한다. 이렇게 할 경우 Googlebot이 최소한 해당 페이지에 뭐가 있는지는 파악할 수 있게 된다.</p>

<p>Hybrid 방식에는 아래와 같은 단점이 있다.</p>

<ul>
  <li>더 설정하기가 까다롭다.</li>
  <li>스크립트에 정의해놓은 경로에 대해서만 SEO가 괜찮아진다.</li>
  <li>페이지 리소스를 로드하는 데에 클라이언트와 서버에서 코드가 중복된다.</li>
</ul>

<h3 id="3-4-isomorphic">3-4. Isomorphic</h3>

<p>서버 사이드 렌더링을 하면 된다. <a href="../server-side-rendering/">이전 블로그 글</a>에 자세한 내용을 적었다.</p>

<p>Isomorphic 방식에는 아래와 같은 단점이 있다.</p>

<ul>
  <li>서버가 javascript를 구동할 수 있어야 한다.</li>
  <li>서버 사이드에서 <code class="language-plaintext highlighter-rouge">window</code>를 사용하는 경우를 비롯해 개발하기 까다로운 부분이 다수 있다.</li>
  <li>이제까지의 해결 방법 중에서 러닝 커브가 제일 크다.</li>
</ul>

<hr />

<h2 id="4-내가-선택한-방법">4. 내가 선택한 방법</h2>

<p>나는 POC 성격의 작은 어플리케이션을 개발했기 때문에, SSR을 해보려고 많은 삽질을 하다가 결국 Catch-all 방식으로 구현했었다. 만약 실무에서 대 고객 사이트를 대상으로 개발을 하게 된다면 프론트엔드 파트와 협의해서 SSR을 하던가, Hybrid 방식으로 가지 않을까 싶다.</p>


                        </div>
                        <!-- Blog Content Start -->
                    </div>
                </article>
            </div>
        </div>
    </div>
</section>

<!-- Pagination Start -->
<section class="uk-section uk-section-small">
    <div class="uk-container uk-container-small">
        <div class="tw-portfolio-nav uk-flex uk-flex-between uk-flex-middle">
            
            <div class="nav-prev tw-meta">
                <a href="../server-side-rendering/">
                    <i class="ion-ios-arrow-left"></i>
                    <span>Prev</span>
                </a>
            </div>
            
            <div class="nav-link">
                <a href="/blog">
                    <i class="ion-grid"></i>
                </a>
            </div>
            
            <div class="nav-next tw-meta">
                <a href="../backend-performance-test/">
                    <span>Next</span>
                    <i class="ion-ios-arrow-right"></i>
                </a>
            </div>
            
        </div>
    </div>
</section>
<!-- Pagination End -->


<script>
    function getTOCNodes(master) {
        var nodes = Array.prototype.slice.call(master.getElementsByTagName("*"), 0);
        var tocNodes = nodes.filter(function(elem) {
            return elem.tagName == "A";
        });
        return tocNodes;
    }
    function getHeaderNodes(master) {
        var nodes = Array.prototype.slice.call(master.getElementsByTagName("*"), 0);
        var headerNodes = nodes.filter(function(elem) {
            return elem.tagName == "H1" || elem.tagName == "H2" || elem.tagName == "H3";
        });
        return headerNodes;
    }
  
    var title = document.getElementsByClassName("post-title")[0];
    var titleY = window.pageYOffset + title.getBoundingClientRect().top;
    
    var article = document.getElementsByClassName("post-article")[0];
    var articleY = window.pageYOffset + article.getBoundingClientRect().top;
  
    var toc = document.getElementsByClassName("toc")[0];
  
    var headerNodes = getHeaderNodes(article);
    var tocNodes = getTOCNodes(toc);
  
    var before = undefined;
  
    document.addEventListener('scroll', function(e) {
        if (window.scrollY >= articleY - 60) {
            toc.style.cssText = "position: fixed; top: 60px;";
        }
        else {
            toc.style.cssText = "";
        }
    
        var current = headerNodes.filter(function(header) {
            var headerY = window.pageYOffset + header.getBoundingClientRect().top;
            return window.scrollY >= headerY - 200;
        });
  
        if (current.length > 0) {
            current = current[current.length-1];
    
            var currentA = tocNodes.filter(function(tocNode) {
                return tocNode.innerHTML == current.innerHTML;
            })
            
            currentA = currentA[0];
            if (currentA) {
                if (before == undefined) before = currentA;
        
                if (before != currentA) {
                    before.classList.remove("toc-active");
                    before = currentA;
                }
        
                currentA.classList.add("toc-active");
            }
            else {
                if (before) 
                    before.classList.remove("toc-active");
            }
        }
        else {
            if (before) 
                before.classList.remove("toc-active");
        }
    }, false);
</script>

    
    
</div>


        </main>
        <!-- Content End -->
      
        <footer class="uk-section uk-padding-remove-vertical uk-light">
    <div class="footer-area footer-small">
        <div class="uk-container">
            <div class="uk-flex-middle uk-child-width-1-3" data-uk-grid>
                <div class="tw-element tw-socials tw-no-bg with-hover">
                    <a href="https://github.com/llb1026" target="_blank"><i class="uk-icon-button tw-margin fa fa-github"></i></a>
                    <a href="https://www.linkedin.com/in/jiyun-lee-b19a02153" target="_blank"><i class="uk-icon-button tw-margin fa fa-linkedin"></i></a>
                </div>
                <div class="uk-text-center copyright">
                    © JIYUN.ME
                </div>
                <div class="uk-text-right">
                    <a href="" data-uk-scroll>Top &nbsp;&nbsp;<i class="ion-ios-arrow-up"></i></a>
                </div>
            </div>
        </div>
    </div>
</footer>

   
        <script src="/assets/js/jquery-3.2.0.min.js"></script>
        <script src="/assets/js/jquery.easypiechart.min.js"></script>
        <script src="/assets/js/uikit.min.js"></script>
        <script src="/assets/js/uikit-icons.min.js"></script>
        <script src="/assets/js/isotope.pkgd.min.js"></script>
        <script src="/assets/js/owl.carousel.min.js"></script>
        <script src="/assets/js/theme.js"></script>
        

    </body>
</html>
