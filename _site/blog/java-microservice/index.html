<!DOCTYPE html>
<html lang="ko">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>자바 기반의 마이크로서비스 이해와 아키텍처 구축하기</title>
        
    <!-- Post info -->

    <meta property="og:site_name" content="JIYUN.ME">
    <meta property="og:type" content="website" /> 
    <meta property="og:url" content="http://localhost:4000/blog/java-microservice/" />
    
    <meta property="og:image" content="http://localhost:4000/blog/java-microservice/img/bg.jpg">

    <!-- title -->
    <meta property="og:title" content="JIYUN.ME | 자바 기반의 마이크로서비스 이해와 아키텍처 구축하기">
    
    <!-- description -->
    <meta property="og:description" content="## 기본 베이스 지식 - 소프트웨어 아키텍처: 소프트웨어를 **구성하는** 요소들, 그리고 각 요소간의 관계를 정의해 그려놓은 것 - 4+1 View: 아키텍처의 표현을 5가지 관점에서 접근해 표현한 것 1. Logic View:..."/>
        
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/uikit.min.css">
    <link rel="stylesheet" href="/assets/css/uikit-width-ex.min.css">
    <link rel="stylesheet" href="/assets/css/ionicons.min.css">
    <link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/assets/css/font-awesome.css">
    <link rel="stylesheet" href="/assets/css/animations.css">
    <link rel="stylesheet" href="/assets/css/theme.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">
    <link rel="stylesheet" href="/assets/css/toc.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="stylesheet" href="/assets/js/prettify/skins/github2.css">
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700%7CLora:400,400i%7CShadows+Into+Light:400" rel="stylesheet" />
    <link rel="shortcut icon" href="/assets/img/favicon_2.ico">
    
</head>

    
    <body class="loading">
        

        <!-- NavBar Start -->
        <div class="tw-preloader">
            <div data-uk-spinner></div>
        </div>

        <!-- 
        <div class="header-container tw-header uk-dark">
         -->
        <div class="header-container tw-header tw-header-transparent uk-dark" style="background-color: rgba(255, 255, 255, 0.25);">
        
            <nav class="uk-navbar-container uk-flex-center" data-uk-navbar>

                <!-- NavBar Left Logo Start -->
                <div class="uk-navbar-left">
                    <div class="tw-logo">
                        <h3 class="site-name">
                            <a href="/">JIYUN.ME</a>
                        </h3>
                    </div>
                </div>
                <!-- NavBar Left Logo End -->

                <!-- NavBar Center Menu Start -->
                <div class="uk-navbar-center" id="top">
                    <ul class="tw-main-menu uk-visible@m">
                        <li class="menu-item">
                            <a href="/"  class="normal"  class="active">Home</a>
                        </li>
                        <li class="menu-item">
                            <a href="/projects"  >Projects</a>
                        </li>
                        <li class="menu-item">
                            <a href="/blog"  class="active" >Blog</a>
                        </li>
                        <!-- <li class="menu-item">
                            <a href="/guestbook"  >Guestbook</a>
                        </li> -->
                    </ul>
                </div>
                <!-- NavBar Center Menu End -->

                <!-- NavBar Right Menu Icon Start -->
                <div class="uk-navbar-right">
                    <div class="tw-header-meta">
                        <a class="mobile-menu uk-navbar-toggle uk-hidden@m" href="#" data-uk-toggle="target: #mobile-menu-modal"><i class="ion-navicon-round"></i></a>
                    </div>
                </div>
                <!-- NavBar Right Menu Icon End -->

                <!-- NavBar Right Menu List Start -->
                <div id="mobile-menu-modal" class="uk-modal-full" data-uk-modal>
                    <div class="uk-modal-dialog">
                        <button class="uk-modal-close-full" type="button" data-uk-close></button>
                        <div class="uk-light uk-height-viewport tw-mobile-modal uk-flex uk-flex-middle uk-flex-center" data-uk-scrollspy="target:>ul>li,>div>a; cls:uk-animation-slide-bottom-medium; delay: 150;">
                            <ul class="uk-nav-default" data-uk-nav>
                                <li class="uk-nav-default">
                                    <a href="/"  class="normal"  class="active">Home</a>
                                </li>
                                <li class="uk-nav-default">
                                    <a href="/projects"  >Projects</a>
                                </li>
                                <li class="uk-nav-default">
                                    <a href="/blog"  class="active" >Blog</a>
                                </li>
                                <!-- <li class="uk-nav-default">
                                    <a href="/guestbook"  >Guestbook</a>
                                </li> -->
                            </ul>

                            <div class="tw-socials tw-socials-minimal">
                                <a href="https://github.com/llb1026" target="_blank"><i class="uk-icon-button tw-margin fa fa-github"></i></a>
                                <a href="https://www.linkedin.com/in/jiyun-lee-b19a02153" target="_blank"><i class="uk-icon-button tw-margin fa fa-linkedin"></i></a>
                            </div>

                        </div>
                    </div>
                </div>
                <!-- NavBar Right Menu List End -->

            </nav>
        </div>
        <!-- NavBar End -->
    
        <!-- Content Start -->
        <main>
            <div class="main-container">

    
        <br /><br />
<section class="uk-section-normal uk-section-blog" style="padding-bottom: 0;">
    <div class="uk-container uk-container-small">
        <div data-uk-grid>
            <div class="content-area uk-width-expand">

                <article class="single post">
                    <div class="entry-post">
                        <div class="entry-cats tw-meta">
                            <p>tech-notes</p>
                        </div>
                        <!-- <h2 class="entry-title post-title">
                            <a href="#">자바 기반의 마이크로서비스 이해와 아키텍처 구축하기</a>
                        </h2> -->
                        <div class="heading-title post-title">
                            <h2 class="title">자바 기반의 마이크로서비스 이해와 아키텍처 구축하기</h2>
                        </div>
                        <div class="entry-date tw-meta">
                            <span>이건 샘플이야</span>
                        </div>

                        <!-- Blog Content Start -->
                        <div class="post-article">

                            <!-- Title Image Start -->
                            <div class="entry-media uk-padding-small">
                                <div class="tw-thumbnail" data-uk-lightbox>
                                    <img src="img/bg.jpg" alt="" />
                                    <div class="image-overlay">
                                        <a href="img/bg.jpg"></a>
                                    </div>
                                </div>
                            </div>
                            <!-- Title Image End -->

                            <!-- Scroll Spy TOC Start -->
                            <div class="toc">
                                <a href="#top">&#x1F446; 맨 위로</a>
                                <ul><li><a href="#기본-베이스-지식">기본 베이스 지식</a></li><li><a href="#모놀리식-아키텍처-vs-msa">모놀리식 아키텍처 vs MSA</a></li><li><a href="#soa-vs-msa">SOA vs MSA</a></li><li><a href="#왜-msa인가">왜 MSA인가</a></li><li><a href="#왜-클라우드-네이티브인가">왜 클라우드 네이티브인가</a></li><li><a href="#software-as-a-service">Software as a Service</a></li><li><a href="#마이크로서비스로의-전환">마이크로서비스로의 전환</a></li><li><a href="#현실은">현실은</a></li><li><a href="#appendix">Appendix</a></li></ul>
                            </div>
                            <!-- Scroll Spy TOC End -->

                            <h2 id="기본-베이스-지식">기본 베이스 지식</h2>
<ul>
  <li>소프트웨어 아키텍처: 소프트웨어를 <strong>구성하는</strong> 요소들, 그리고 각 요소간의 관계를 정의해 그려놓은 것</li>
  <li>4+1 View: 아키텍처의 표현을 5가지 관점에서 접근해 표현한 것
    <ol>
      <li>Logic View: 소프트웨어를 구성하는 요소들의 관계 구조 표현</li>
      <li>Process View: 소프트웨어 간의 동적 흐름, 스레드나 프로세스 등의 동시성 처리 표현</li>
      <li>Implementation View: 논리적인 설계가 실제로 구현된 측면에서 소프트웨어의 구성과 구조 표현</li>
      <li>Deployment View: 시스템에서의 소프트웨어 배치 표현</li>
      <li>Usecase View: 시스템의 사용 사례 표현</li>
    </ol>
  </li>
  <li>소프트웨어의 기능적 측면 뿐만 아니라, 전체적인 뼈대(아키텍처)를 제대로 설계해야 프로그램을 안정적으로 연결하고 운영할 수 있다</li>
  <li>아키텍처 스타일: 특정 제약 조건에서 문제 상황을 해결할 접근 방법을 제공, 그러나 정답을 주진 않음 (MSA도 기존 모놀리식 구조의 문제점 해결을 위한 접근방법에 해당하는 스타일)</li>
  <li>아키텍처 패턴: 구체적 문제점에 대한 k해결 방안을 경험적 사례 기반으로 제시함</li>
</ul>

<hr />

<h2 id="모놀리식-아키텍처-vs-msa">모놀리식 아키텍처 vs MSA</h2>
<ul>
  <li>모놀리식 아키텍처: 모든 업무 로직이 하나의 큰 어플리케이션 형태로 패키징되어 서비스됨 (데이터도 한 곳에 모인 데이터를 참조)</li>
  <li>마이크로서비스 아키텍처: 작은 단위로 동작하는 서비스<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>가 구동되도록 시스템 및 소프트웨어의 구성과 구성 요소 간의 관계를 정의하고 설계하는 방식 (어플리케이션 기능 뿐만 아니라 데이터도 분리)</li>
  <li>차이점: <em>하나</em>의 어플리케이션 vs 분할된 <em>다수</em>의 서비스와 데이터</li>
</ul>

<hr />

<h2 id="soa-vs-msa">SOA vs MSA</h2>
<ul>
  <li>SOA(Service Oriented Architecture): 전체 시스템을 데이터 중심이 아닌 서비스 중심으로 설계하는 스타일</li>
  <li>SOA의 특징
    <ol>
      <li>서비스 계약: 서비스는 소비자와 약속한 기능을 수행해야 하고, 소비자는 서비스 사용 계약 규칙을 준수 → 서비스 개선에 따라 여러 버전의 계약 발생</li>
      <li>
        <table>
          <tbody>
            <tr>
              <td>서비스 가용성: 서비스 타임아웃 기능 및 서비스 라우팅 구현을 권장 → L4/L7과 같은 하드웨어 라우팅</td>
              <td> </td>
              <td>circuit breaker와 같은 소프트웨어 기능적 라우팅</td>
            </tr>
          </tbody>
        </table>
      </li>
      <li>보안: 서비스 간 호출 시 인증 및 권한 확인 제어권을 서비스 자체에 넘기는 방식 권장</li>
      <li>트랜잭션: Read용 DB와 Write용 DB 분리 권장 (7:3 규칙)</li>
      <li>서비스 관리: 서비스 상태 모니터링 및 장애 대응</li>
    </ol>
  </li>
</ul>

<div class="tw-element tw-table">
	<table class="uk-table-small uk-table style-2 uk-table-striped">
		<thead>
			<tr>
				<th>구분</th>
				<th>MSA</th>
				<th>SOA</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><em>사상</em></td>
				<td>서비스 지향</td>
				<td>서비스 지향</td>
			</tr>
			<tr>
				<td><em>서비스 오너십</em></td>
				<td>팀 단위 자율성 부여</td>
				<td>팀간 협업</td>
			</tr>
			<tr>
				<td><em>서비스 크기</em></td>
				<td>SOA 대비 작음</td>
				<td>MSA 대비 큼</td>
			</tr>
			<tr>
				<td><em>서비스 공유 정보</em></td>
				<td>서비스 간 독립</td>
				<td>서비스 공유</td>
			</tr>
			<tr>
				<td><em>서비스 공유 방식</em></td>
				<td>API</td>
				<td>서비스 공유를 위한 미들웨어</td>
			</tr>
			<tr>
				<td><em>서비스 통신 방식</em></td>
				<td>RESTful API 등</td>
				<td>SOAP, WSDL, UDDI, ESB 등</td>
			</tr>
		</tbody>
	</table>
</div>

<hr />

<h2 id="왜-msa인가">왜 MSA인가</h2>
<ul>
  <li><em>독립적</em>으로 실행되면서 다른 서비스에 영향을 주지 않기 때문 → loose coupling, high cohesion을 서비스/시스템 레벨에서 구현</li>
  <li>구현, 배포, 실행, 장애 발생에서 각 서비스가 독립적 → 장애 확산 방지, 빠른 장애 대응, 유연한 확장, 잦은 변경 배포에 용이</li>
  <li>클라우드 네이티브 환경에 적합 → <em>즉시성</em>, <em>유연성</em></li>
</ul>

<hr />

<h2 id="왜-클라우드-네이티브인가">왜 클라우드 네이티브인가</h2>
<ul>
  <li>Scale-out에 유연하고, 서비스 변화 및 장애로 인한 영향을 최소화하도록 설계됨</li>
  <li>Docker 컨테이너 기반 서비스 운영 &amp;&amp; CI/CD <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup></li>
</ul>

<hr />

<h2 id="software-as-a-service">Software as a Service</h2>
<ul>
  <li>SaaS: 특정 기간 or 기능만 필요한 만큼 구매하여 사용하는 주문형 서비스 형태의 클라우드 네이티브 소프트웨어 (MSA가 SaaS 어플리케이션 개발에 적합)</li>
  <li>12 Factor
    <ol>
      <li>코드베이스: 하나의 어플리케이션은 하나의 코드베이스를 가지고 버전으로 관리되어야 함 (Gitlab)</li>
      <li>종속성: 어플리케이션에 사용된 라이브러리들끼리 명시적으로 선언되지 않은 종속성이 발생하면 안 됨</li>
      <li>환경 설정: config 정보는 코드와 완전히 분리되어 관리되어야 함</li>
      <li>백엔드 서비스: DB, 메시지 큐와 같이 연결하거나 분리할 때 코드 수정 없이 독립적으로 수행할 수 있어야 함</li>
      <li>빌드, 릴리즈, 실행: 코드는 빌드 → 릴리즈 → 실행 단계로 분리되어 운영됨</li>
      <li>프로세스: 프로세스는 stateless해야 하며, 상태 정보를 보관해야 할 필요가 있다면 DB를 사용해야 함 (e.g. sticky session 지양)</li>
      <li>포트 바인딩: 포트 바인딩된 독립 서비스들은 다른 서비스의 백엔드 서비스로도 활용될 수 있음</li>
      <li>동시성: 특정 서비스 시스템에 부하 발생 시 scale-up보다 scale-out할 수 있는 프로세스 모델 형태 필요</li>
      <li>폐기 가능: graceful shutdown이 보장되어야 함</li>
      <li>개발, 테스트, 운영환경의 일관성: 각 환경이 최대한 같아야 함</li>
      <li>로그: 어플리케이션에서 로그 처리/가공/관리에 관여해서는 안 됨 → 스트림 이벤트로 취급하여 흘려보내고, 이를 수집하는 별도 툴을 이용해 관리해야 함</li>
      <li>일회성 프로세스: 일회성 작업은 구분하여 별도의 프로세스로 구성해야 함 (e.g. 관리자 관련 작업, 유지보수 관련 작업)</li>
    </ol>
  </li>
</ul>

<hr />

<h2 id="마이크로서비스로의-전환">마이크로서비스로의 전환</h2>
<ul>
  <li>도메인에 따라 서비스 경계를 식별/평가해야 함 (e.g. 조직을 기준으로 서비스를 구성, 서비스 중요도 기준으로 서비스의 경계를 구분)</li>
  <li>서비스 분할
    <ul>
      <li>하향식 접근: 업무 흐름 및 중요도 기준으로 서비스 분할</li>
      <li>상향식 접근: 데이터 특성을 고려해 서비스 분할</li>
      <li>점진적 접근: 비즈니스 영향도가 적은 서비스부터 점진적으로 분할</li>
    </ul>
  </li>
  <li>조직 구성, Agile 방법론, DevOps 체계, 인프라(클라우드 네이티브 기술 환경)가 함께 고려되어야 함</li>
  <li>커피 전문점 예제 <sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup></li>
</ul>

<hr />

<h2 id="현실은">현실은</h2>
<ul>
  <li>짧은 구글링 결과, MSA를 도입한 후기에서 아래와 같은 공통 허들 발견
    <ul>
      <li>팀원이 전체적으로 실력이 좋아야 함</li>
      <li>좋은 커뮤니케이션이 필수적으로 전제되어야 함</li>
      <li>기존 SI나 프로젝트 성격의 개발 후 서비스 담당멤버를 운영인력으로 교체하는 방식에는 매우 적합하지 않음</li>
      <li>서비스 별로 다른 기술 스택을 가져갈 수 있는 MSA 특성으로 인해 운영 관점에서 여러 기술을 동시에 다뤄야 함 (장점으로 볼 수도 있음)</li>
      <li>서비스 간 일정 관리가 복잡해짐</li>
      <li>장애 관리가 더 어려워지는 경우 발생 (e.g. dependency 이슈[^MicroServices does not automatically mean better availability - Unless you have Fault Tolerant Architecture])</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="appendix">Appendix</h2>
<ul>
  <li><a href="https://www.itfind.or.kr/WZIN/jugidong/1887/file2645276227345330267-188702.pdf">MSA에 대한 이해와 컨테이너 기술의 활용 방안.pdf</a></li>
  <li><a href="https://gwonsungjun.github.io/articles/2018-04/springCamp2018">Spring Camp 2018 - MSA 관련 세션 후기</a></li>
  <li><a href="https://www.slideshare.net/stonse/microservices-at-netflix">MicroServices at Netflix - challenges of scale</a></li>
</ul>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>작은 서비스를 식별하기 위한 이론은 Domain Driven Design 참고 <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>카나리 배포, Blue-Green 배포 <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p><a href="https://img1.daumcdn.net/thumb/R720x0.q80/?scode=mtistory2&amp;fname=http%3A%2F%2Fcfile7.uf.tistory.com%2Fimage%2F993002505C89B48D0DE0B6">전체 아키텍처 이미지</a> <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>


                        </div>
                        <!-- Blog Content Start -->
                    </div>
                </article>
            </div>
        </div>
    </div>
</section>

<!-- Pagination Start -->
<section class="uk-section uk-section-small">
    <div class="uk-container uk-container-small">
        <div class="tw-portfolio-nav uk-flex uk-flex-between uk-flex-middle">
            <div class="nav-prev tw-meta">
                <!-- <a href="12">
                    <i class="ion-ios-arrow-left"></i>
                    <span>Prev</span>
                </a> -->
            </div>
            <div class="nav-link">
                <a href="/blog">
                    <i class="ion-grid"></i>
                </a>
            </div>
            <div class="nav-next tw-meta">
                <!-- <a href="">
                    <span>Next</span>
                    <i class="ion-ios-arrow-right"></i>
                </a> -->
            </div>
        </div>
    </div>
</section>
<!-- Pagination End -->


<script>
    function getTOCNodes(master) {
        var nodes = Array.prototype.slice.call(master.getElementsByTagName("*"), 0);
        var tocNodes = nodes.filter(function(elem) {
            return elem.tagName == "A";
        });
        return tocNodes;
    }
    function getHeaderNodes(master) {
        var nodes = Array.prototype.slice.call(master.getElementsByTagName("*"), 0);
        var headerNodes = nodes.filter(function(elem) {
            return elem.tagName == "H1" || elem.tagName == "H2" || elem.tagName == "H3";
        });
        return headerNodes;
    }
  
    var title = document.getElementsByClassName("post-title")[0];
    var titleY = window.pageYOffset + title.getBoundingClientRect().top;
    
    var article = document.getElementsByClassName("post-article")[0];
    var articleY = window.pageYOffset + article.getBoundingClientRect().top;
  
    var toc = document.getElementsByClassName("toc")[0];
  
    var headerNodes = getHeaderNodes(article);
    var tocNodes = getTOCNodes(toc);
  
    var before = undefined;
  
    document.addEventListener('scroll', function(e) {
        if (window.scrollY >= articleY - 60) {
            toc.style.cssText = "position: fixed; top: 60px;";
        }
        else {
            toc.style.cssText = "";
        }
    
        var current = headerNodes.filter(function(header) {
            var headerY = window.pageYOffset + header.getBoundingClientRect().top;
            return window.scrollY >= headerY - 200;
        });
  
        if (current.length > 0) {
            current = current[current.length-1];
    
            var currentA = tocNodes.filter(function(tocNode) {
                return tocNode.innerHTML == current.innerHTML;
            })
            
            currentA = currentA[0];
            if (currentA) {
                if (before == undefined) before = currentA;
        
                if (before != currentA) {
                    before.classList.remove("toc-active");
                    before = currentA;
                }
        
                currentA.classList.add("toc-active");
            }
            else {
                if (before) 
                    before.classList.remove("toc-active");
            }
        }
        else {
            if (before) 
                before.classList.remove("toc-active");
        }
    }, false);
</script>

    
    
</div>


        </main>
        <!-- Content End -->
      
        <footer class="uk-section uk-padding-remove-vertical uk-light">
    <div class="footer-area footer-small">
        <div class="uk-container">
            <div class="uk-flex-middle uk-child-width-1-3" data-uk-grid>
                <div class="tw-element tw-socials tw-no-bg with-hover">
                    <a href="https://github.com/llb1026" target="_blank"><i class="uk-icon-button tw-margin fa fa-github"></i></a>
                    <a href="https://www.linkedin.com/in/jiyun-lee-b19a02153" target="_blank"><i class="uk-icon-button tw-margin fa fa-linkedin"></i></a>
                </div>
                <div class="uk-text-center copyright">
                    © JIYUN.ME
                </div>
                <div class="uk-text-right">
                    <a href="" data-uk-scroll>Top &nbsp;&nbsp;<i class="ion-ios-arrow-up"></i></a>
                </div>
            </div>
        </div>
    </div>
</footer>

   
        <script src="/assets/js/jquery-3.2.0.min.js"></script>
        <script src="/assets/js/jquery.easypiechart.min.js"></script>
        <script src="/assets/js/uikit.min.js"></script>
        <script src="/assets/js/uikit-icons.min.js"></script>
        <script src="/assets/js/isotope.pkgd.min.js"></script>
        <script src="/assets/js/owl.carousel.min.js"></script>
        <script src="/assets/js/theme.js"></script>
        

        <!-- Google Analytics Start -->

        <!-- Google Analytics End -->

    </body>
</html>
